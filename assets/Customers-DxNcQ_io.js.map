{"version":3,"mappings":"y3BACA,MAAMA,GAAa,CACjB,MAAO,6BACP,cAAe,+BACf,QAAS,aACX,EACAC,GAAeC,EAAgB,CAC7B,KAAM,qBACN,OAAQ,SAAgBC,EAAMC,EAAQ,CACpC,OACEC,EAAU,EACVC,EACE,MACAN,GACAI,EAAO,CAAC,IACLA,EAAO,CAAC,EAAI,CACXG,EACE,OACA,CACE,EAAG,wKACH,KAAM,OACN,OAAQ,eACR,iBAAkB,QAClB,kBAAmB,QACnB,eAAgB,IAChC,EACc,KACA,EACd,EACYA,EACE,OACA,CACE,KAAM,OACN,OAAQ,eACR,iBAAkB,QAClB,kBAAmB,QACnB,eAAgB,KAChB,EAAG,2BACnB,EACc,KACA,EACd,EACYA,EACE,OACA,CACE,KAAM,OACN,OAAQ,eACR,iBAAkB,QAClB,kBAAmB,QACnB,eAAgB,KAChB,EAAG,oBACnB,EACc,KACA,EACd,CACA,EACA,CAEE,CACF,CAAC,EC1DKP,GAAa,CACjB,MAAO,6BACP,cAAe,+BACf,QAAS,aACX,EACAQ,GAAeN,EAAgB,CAC7B,KAAM,0BACN,OAAQ,SAAgBC,EAAMC,EAAQ,CACpC,OACEC,EAAU,EACVC,EACE,MACAN,GACAI,EAAO,CAAC,IACLA,EAAO,CAAC,EAAI,CACXG,EACE,SACA,CACE,GAAI,MACJ,GAAI,MACJ,EAAG,KACH,KAAM,OACN,OAAQ,eACR,oBAAqB,KACrB,eAAgB,IAChC,EACc,KACA,EACd,EACYA,EACE,SACA,CACE,GAAI,MACJ,GAAI,MACJ,EAAG,KACH,KAAM,OACN,OAAQ,eACR,oBAAqB,KACrB,eAAgB,IAChC,EACc,KACA,EACd,EACYA,EACE,SACA,CACE,GAAI,MACJ,GAAI,KACJ,EAAG,KACH,KAAM,OACN,OAAQ,eACR,oBAAqB,KACrB,eAAgB,IAChC,EACc,KACA,EACd,CACA,EACA,CAEE,CACF,CAAC,+QCoHD,MAAME,EAAQC,EACRC,EAAOC,EAKPC,EAAUC,GAAA,EACVC,EAAgBC,GAAA,EAEhBC,EAAYC,EAAS,CACzB,IAAK,IAAMT,EAAM,KACjB,IAAKU,GAAOR,EAAK,cAAeQ,CAAG,EACpC,EAEKC,EAAcC,EAAI,CAAC,EACnBC,EAAaD,EAA6C,SAAS,EACnEE,EAAYF,EAAI,EAAK,EAErBG,EAAYH,EAAW,EAAE,EACzBI,EAAeJ,EAA6C,EAAE,EAC9DK,EAAgBL,EAA4B,EAAE,EAC9CM,EAAcN,EAAW,EAAE,EAE3BO,EAAeP,EAAI,CACvB,QAAS,EACT,OAAQ,EACR,OAAQ,EAAC,CACV,EAEKQ,EAAe,CACnB,CAAE,IAAK,OAAQ,MAAO,OAAQ,SAAU,IACxC,CAAE,IAAK,UAAW,MAAO,OAAQ,SAAU,IAC3C,CAAE,IAAK,UAAW,MAAO,MAAO,SAAU,IAC1C,CAAE,IAAK,UAAW,MAAO,QAAS,SAAU,IAC5C,CAAE,IAAK,UAAW,MAAO,KAAM,SAAU,IACzC,CAAE,IAAK,eAAgB,MAAO,OAAQ,SAAU,IAChD,CAAE,IAAK,QAAS,MAAO,KAAM,SAAU,IACvC,CAAE,IAAK,QAAS,MAAO,KAAM,SAAU,IACvC,CAAE,IAAK,SAAU,MAAO,OAAQ,SAAU,IAC1C,CAAE,IAAK,SAAU,MAAO,KAAM,SAAU,GAAM,EAG1CC,EAAiBZ,EAAS,IAAM,CACpC,CAAE,MAAO,KAAM,IAAK,WACpB,CAAE,MAAO,MAAO,IAAK,WACrB,CAAE,MAAO,KAAM,IAAK,WACpB,CAAE,MAAO,KAAM,IAAK,WACpB,CAAE,MAAO,KAAM,IAAK,SACpB,CAAE,MAAO,OAAQ,IAAK,eAAe,CACtC,EAEKa,EAAUb,EAAS,IACnBE,EAAY,QAAU,EACjBI,EAAU,MAAM,OAAS,EAE9BJ,EAAY,QAAU,EACDS,EAAa,OAAOG,GAAKA,EAAE,QAAQ,EACpC,MAAMA,GAAKN,EAAc,MAAMM,EAAE,GAAG,CAAC,EAEtD,EACR,EAED,eAAeC,EAAiBC,EAAqC,CACnE,KAAM,CAAE,KAAAC,GAASD,EACjB,GAAI,CACF,MAAME,EAAO,MAAMD,EAAK,MAAM,cAC9B,GAAI,CAACC,EACH,MAAM,IAAI,MAAM,QAAQ,EAG1B,MAAMC,EAAWC,GAAKF,CAAI,EACpBG,EAAaF,EAAS,OAAOA,EAAS,WAAW,CAAC,CAAC,EACnDG,EAAWC,EAAM,cAAcF,EAAY,CAAE,IAAK,GAAO,EAE/D,GAAIC,EAAS,SAAW,EACtB,MAAM,IAAI,MAAM,SAAS,EAG3BhB,EAAU,MAAQgB,EAGlB,MAAME,EAAU,OAAO,KAAKF,EAAS,CAAC,CAAW,EACjDf,EAAa,MAAQiB,EAAQ,IAAIC,IAAQ,CAAE,MAAOA,EAAK,MAAOA,CAAA,EAAM,EAGpEd,EAAa,QAAQe,GAAS,CAC5B,MAAMC,EAAaH,EAAQ,KAAKC,IAC9BA,GAAI,cAAc,SAASC,EAAM,MAAM,aAAa,GAElDC,IACFnB,EAAc,MAAMkB,EAAM,GAAG,EAAIC,EAErC,CAAC,EAEDhC,EAAQ,QAAQ,QAAQ,EACxBO,EAAY,MAAQ,CACtB,OAAS0B,EAAY,CACnBjC,EAAQ,MAAM,UAAYiC,EAAM,OAAO,CACzC,CACF,CAEA,SAASC,GAAa,CAChB3B,EAAY,QAAU,IAExBO,EAAY,MAAQH,EAAU,MAAM,IAAIwB,GAAO,CAC7C,MAAMC,EAAc,GACpB,cAAO,QAAQvB,EAAc,KAAK,EAAE,QAAQ,CAAC,CAACwB,EAAUC,CAAQ,IAAM,CAChEA,IACFF,EAAOC,CAAQ,EAAIF,EAAIG,CAAQ,EAEnC,CAAC,EACMF,CACT,CAAC,GAEH7B,EAAY,OACd,CAEA,SAASgC,GAAa,CACpBhC,EAAY,OACd,CAEA,eAAeiC,GAAe,CAC5B9B,EAAU,MAAQ,GAClB,GAAI,CACF,MAAM+B,EAAY3B,EAAY,MAAM,IAAIS,IAAS,CAC/C,GAAGA,EACH,OAAQ,MACR,OAAQA,EAAK,QAAU,QACvB,WAAY,IACZ,EAEImB,EAAS,MAAMxC,EAAc,gBAAgBuC,CAAS,EAC5D1B,EAAa,MAAQ2B,EAErBnC,EAAY,MAAQ,EACpBE,EAAW,MAAQiC,EAAO,SAAW,EAAI,SAAW,QAEhDA,EAAO,SAAW,GACpB1C,EAAQ,QAAQ,QAAQ0C,EAAO,OAAO,MAAM,EAC5C5C,EAAK,SAAS,GAEdE,EAAQ,QAAQ,WAAW0C,EAAO,OAAO,SAASA,EAAO,MAAM,IAAI,CAEvE,OAAST,EAAY,CACnBjC,EAAQ,MAAM,QAAUiC,EAAM,OAAO,EACrCxB,EAAW,MAAQ,OACrB,SACEC,EAAU,MAAQ,EACpB,CACF,CAEA,SAASiC,GAAmB,CAC1B,MAAMC,EAAW,CACf,CACE,KAAM,iBACN,KAAM,YACN,IAAK,KACL,QAAS,KACT,GAAI,OACJ,KAAM,aACN,GAAI,sBACJ,GAAI,kBACJ,KAAM,UACN,GAAI,WACN,EAGIC,EAAKjB,EAAM,cAAcgB,CAAQ,EACjCE,EAAKlB,EAAM,WACjBA,EAAM,kBAAkBkB,EAAID,EAAI,QAAQ,EAExCE,GAAUD,EAAI,aAAa,EAC3B9C,EAAQ,QAAQ,QAAQ,CAC1B,CAEA,SAASgD,GAAc,CACrBzC,EAAY,MAAQ,EACpBE,EAAW,MAAQ,UACnBE,EAAU,MAAQ,GAClBC,EAAa,MAAQ,GACrBC,EAAc,MAAQ,GACtBC,EAAY,MAAQ,GACpBC,EAAa,MAAQ,CAAE,QAAS,EAAG,OAAQ,EAAG,OAAQ,EAAC,EACvDjB,EAAK,cAAe,EAAK,CAC3B,mBAzWEmD,EA0IUC,EAAAC,EAAA,GAzIA,KAAM/C,EAAA,qCAAAA,EAAS,MAAAgD,GACtB,gBAAe,GAChB,OAAO,OACP,MAAM,SACN,wBA+GW,SACT,IAmBU,CAnBVC,EAmBUH,EAAAI,CAAA,GAnBD,QAAQ,OAAK,WACpB,IAEW,CAFK/C,EAAA,SAAmBA,EAAA,MAAW,OAA9C0C,EAEWC,EAAAK,CAAA,SAF0C,QAAOhB,CAAA,aAAY,IAExE,IAAAhD,EAAA,MAAAA,EAAA,OAFwE,QAExE,wBACgBgB,EAAA,MAAW,OAA3B0C,EAEWC,EAAAK,CAAA,SAFsB,KAAK,UAAW,UAAWrC,EAAA,MAAU,QAAOgB,CAAA,aAAY,IAEzF,IAAA3C,EAAA,MAAAA,EAAA,OAFyF,QAEzF,uCAEQgB,EAAA,QAAW,OADnB0C,EAOWC,EAAAK,CAAA,SALT,KAAK,UACJ,QAAS7C,EAAA,MACT,QAAO8B,CAAA,aACT,IAED,IAAAjD,EAAA,MAAAA,EAAA,OAFC,SAED,sCACgBgB,EAAA,QAAW,OAA3B0C,EAEWC,EAAAK,CAAA,SAFwB,KAAK,UAAW,QAAOP,CAAA,aAAa,IAEvE,IAAAzD,EAAA,MAAAA,EAAA,OAFuE,OAEvE,wBACA8D,EAA4CH,EAAAK,CAAA,GAAjC,QAAOP,GAAW,WAAE,IAAE,IAAAzD,EAAA,MAAAA,EAAA,OAAF,KAAE,kCAhIrC,IAKU,CALV8D,EAKUH,EAAAM,EAAA,GALA,QAASjD,EAAA,MAAc,OAAQE,EAAA,kBACvC,IAAuB,CAAvB4C,EAAuBH,EAAAO,CAAA,GAAf,MAAM,OAAM,EACpBJ,EAAsBH,EAAAO,CAAA,GAAd,MAAM,MAAK,EACnBJ,EAAuBH,EAAAO,CAAA,GAAf,MAAM,OAAM,EACpBJ,EAAuBH,EAAAO,CAAA,GAAf,MAAM,OAAM,iCAGtBJ,EAAaH,EAAAQ,EAAA,GAGFnD,EAAA,QAAW,GAAtBf,IAAAC,EA+BM,MA/BNN,GA+BM,CA9BJkE,EAkBWH,EAAAS,EAAA,GAjBR,iBAAgBvC,EAChB,iBAAgB,GACjB,OAAO,8BAEP,IAYmB,CAZnBiC,EAYmBH,EAAAU,EAAA,kBAXjB,IAIM,CAJNlE,EAIM,MAJNmE,GAIM,CAHJR,EAESH,EAAAY,CAAA,GAFD,KAAK,KAAM,MAAO,cACxB,IAAsB,CAAtBT,EAAsBH,EAAA9D,EAAA,aAG1BiE,EAESH,EAAAa,EAAA,GAFD,4BAAwB,WAAC,IAEjC,IAAAxE,EAAA,KAAAA,EAAA,MAFiC,kBAEjC,cACA8D,EAEMH,EAAAc,EAAA,GAFD,MAAM,IAAI,uCAA2B,IAE1C,IAAAzE,EAAA,KAAAA,EAAA,MAF0C,yCAE1C,8BAIJ8D,EAAaH,EAAAQ,EAAA,GAEbL,EAOUH,EAAAe,CAAA,GAPD,KAAK,OAAO,MAAM,mBACzB,IAKK,CALLvE,EAKK,WAJHH,EAAA,KAAAA,EAAA,GAAAG,EAAwC,UAApC,kCAA+B,KACnCH,EAAA,KAAAA,EAAA,GAAAG,EAAiB,UAAb,WAAQ,KACZH,EAAA,KAAAA,EAAA,GAAAG,EAAiC,UAA7B,2BAAwB,KAC5BA,EAAuE,yBAAnE,MAAG,KAAAA,EAAsD,KAAnD,KAAK,IAAK,WAAeiD,EAAgB,cAAE,MAAI,gBAAI,QAAK,6BAM7DpC,EAAA,QAAW,GAAtBf,IAAAC,EAoBM,MApBNyE,GAoBM,CAnBJb,EAEUH,EAAAe,CAAA,GAFD,KAAK,OAAO,MAAM,MAAM,2CAA6B,IAE9D,IAAA1E,EAAA,KAAAA,EAAA,MAF8D,uBAE9D,cAEA8D,EAcSH,EAAAiB,EAAA,GAdD,kBAAgB,OAAO,cAAY,oBAEvC,IAA6B,MAD/B1E,EAYc2E,GAAA,KAAAC,GAXIrD,EAATe,GADTsB,EAYcH,EAAAoB,EAAA,GAVX,IAAKvC,EAAM,IACX,MAAOA,EAAM,MACb,SAAUA,EAAM,qBAEjB,IAKE,CALFsB,EAKEH,EAAAqB,CAAA,GAJQ,MAAO1D,EAAA,MAAckB,EAAM,GAAG,sBAAvBlB,EAAA,MAAckB,EAAM,GAAG,EAAAqB,EACrC,QAASxC,EAAA,MACV,YAAY,gBACZ,uHAOGL,EAAA,QAAW,GAAtBf,IAAAC,EAeM,MAfN+E,GAeM,CAdJnB,EAEUH,EAAAe,CAAA,GAFD,KAAK,UAAU,MAAM,OAAO,2CAA6B,IAC9D,CAD8DQ,EAAA,MAC9DC,EAAG5D,EAAA,MAAY,MAAM,EAAG,iBAC5B,WAEAuC,EAKEH,EAAAyB,EAAA,GAJC,QAAS1D,EAAA,MACT,KAAMH,EAAA,MAAY,MAAK,MACvB,aAAY,IACZ,WAAY,+BAGJA,EAAA,MAAY,OAAM,QAA7BmC,EAEMC,EAAAc,EAAA,SAF8B,MAAM,IAAI,uCAAyB,IAEvE,IAAAzE,EAAA,KAAAA,EAAA,MAFuE,kBAEvE,oCAISgB,EAAA,QAAW,GAAtBf,IAAAC,EAsBM,MAtBNmF,GAsBM,CArBJvB,EAoBWH,EAAA2B,EAAA,GAnBR,OAAQ9D,EAAA,MAAa,SAAM,sBAC3B,MAAOA,EAAA,MAAa,SAAM,wBAEhB,SACT,IAaU,CAbVsC,EAaUH,EAAAI,CAAA,GAbD,aAAQ,WACf,IAAwD,CAAxDD,EAAwDH,EAAA4B,EAAA,GAA3C,MAAM,KAAM,MAAO/D,EAAA,MAAa,2BAC7CsC,EAAuDH,EAAA4B,EAAA,GAA1C,MAAM,KAAM,MAAO/D,EAAA,MAAa,0BAE3BA,EAAA,MAAa,OAAO,OAAM,OAA5CkC,EAQaC,EAAA6B,EAAA,qBAPX,IAMkB,CANlB1B,EAMkBH,EAAA8B,EAAA,GAND,MAAM,SAAS,KAAK,qBACnC,IAIS,CAJT3B,EAISH,EAAA+B,EAAA,kBAHM,IAAoC,EAAjDzF,EAAA,IAAAC,EAEc2E,GAAA,KAAAC,GAFetD,EAAA,MAAa,OAAtBkB,QAApBgB,EAEcC,EAAAgC,EAAA,GAFqC,IAAKjD,EAAM,kBAAO,IACjE,GADiE,MACjEyC,EAAGzC,EAAM,SAAY,OAAIyC,EAAGzC,EAAM,KAAK,8OCI7D,MAAMkD,EAASC,GAAA,EACTC,EAASC,GAAA,EACTtF,EAAUC,GAAA,EACVC,EAAgBC,GAAA,EAEhBoF,EAAe/E,EAAI,EAAK,EACxBgF,EAAkBhF,EAAI,EAAK,EAC3BiF,EAAkBjF,EAAqB,IAAI,EAE3CkF,EAAUC,GAAyB,CACvC,QAAS,GACT,OAAQ,OACR,OAAQ,OACR,QAAS,GACT,WAAY,OACb,EAEKC,EAAgB,CACpB,CAAE,MAAO,QAAS,MAAO,cACzB,CAAE,MAAO,MAAO,MAAO,eACvB,CAAE,MAAO,MAAO,MAAO,iBACvB,CAAE,MAAO,MAAO,MAAO,aACvB,CAAE,MAAO,QAAS,MAAO,aACzB,CAAE,MAAO,SAAU,MAAO,iBAC1B,CAAE,MAAO,OAAQ,MAAO,aACxB,CAAE,MAAO,QAAS,MAAO,cACzB,CAAE,MAAO,MAAO,MAAO,eACvB,CAAE,MAAO,OAAQ,MAAO,kBACxB,CAAE,MAAO,OAAQ,MAAO,eAAe,EAGnCC,EAAgB,CACpB,CAAE,MAAO,KAAM,MAAO,WACtB,CAAE,MAAO,KAAM,MAAO,SACtB,CAAE,MAAO,KAAM,MAAO,cACtB,CAAE,MAAO,MAAO,MAAO,YACvB,CAAE,MAAO,OAAQ,MAAO,aACxB,CAAE,MAAO,OAAQ,MAAO,gBACxB,CAAE,MAAO,KAAM,MAAO,QAAQ,EAG1BC,EAAmB,CACvB,CAAE,MAAO,MAAO,MAAO,IACvB,CAAE,MAAO,MAAO,MAAO,GAAM,EAGzBjE,EAAsC,CAC1C,CACE,MAAO,KACP,IAAK,OACL,MAAO,IACP,MAAO,OACP,OAAQM,GAAO4D,EAAE,IAAK,CAAE,QAAS,IAAMC,EAAW7D,CAAG,GAAKA,EAAI,IAAI,GAEpE,CACE,MAAO,KACP,IAAK,UACL,MAAO,IACP,SAAU,CAAE,QAAS,GAAK,EAE5B,CACE,MAAO,MACP,IAAK,UACL,MAAO,KAET,CACE,MAAO,KACP,IAAK,UACL,MAAO,KAET,CACE,MAAO,KACP,IAAK,UACL,MAAO,IACP,SAAU,CAAE,QAAS,GAAK,EAE5B,CACE,MAAO,KACP,IAAK,SACL,MAAO,IACP,OAAQA,GAAO,CACb,MAAM8D,EAA0D,CAC9D,WAAY,CAAE,KAAM,UAAW,MAAO,SACtC,YAAa,CAAE,KAAM,OAAQ,MAAO,OACpC,cAAe,CAAE,KAAM,UAAW,MAAO,OACzC,UAAW,CAAE,KAAM,UAAW,MAAO,OACrC,UAAW,CAAE,KAAM,OAAQ,MAAO,SAClC,cAAe,CAAE,KAAM,QAAS,MAAO,UACvC,UAAW,CAAE,KAAM,UAAW,MAAO,QACrC,WAAY,CAAE,KAAM,UAAW,MAAO,SACtC,YAAa,CAAE,KAAM,UAAW,MAAO,OACvC,eAAgB,CAAE,KAAM,QAAS,MAAO,QACxC,aAAc,CAAE,KAAM,UAAW,MAAO,OAAO,EAE3C,CAAE,KAAAC,EAAM,MAAAC,GAAUF,EAAU9D,EAAI,MAAM,GAAK,CAAE,KAAM,UAAW,MAAOA,EAAI,QAC/E,OAAO4D,EAAEK,GAAM,CAAE,KAAAF,EAAM,KAAM,SAAW,CAAE,QAAS,IAAMC,EAAO,CAClE,GAEF,CACE,MAAO,OACP,IAAK,aACL,MAAO,IACP,OAAQhE,GAAO4D,EAAEM,GAAS,CAAE,MAAOlE,EAAI,WAAY,SAAU,GAAM,GAErE,CACE,MAAO,OACP,IAAK,eACL,MAAO,IACP,OAAQA,GAAOmE,GAAWnE,EAAI,YAAY,GAE5C,CACE,MAAO,MACP,IAAK,QACL,MAAO,IACP,OAAQA,GAAOA,EAAI,OAAO,MAAQA,EAAI,OAAO,OAAS,KAExD,CACE,MAAO,KACP,IAAK,UACL,MAAO,GACP,MAAO,QACP,OAAQA,GACC4D,EACLQ,GACA,CACE,QAAS,CACP,CAAE,MAAO,KAAM,IAAK,QACpB,CAAE,MAAO,KAAM,IAAK,QACpB,CAAE,MAAO,KAAM,IAAK,SAAS,EAE/B,SAAWC,GAAgBC,EAAaD,EAAKrE,CAAG,GAElD,CACE,QAAS,IACP4D,EACExC,EACA,CAAE,KAAM,IACR,CAAE,KAAM,IAAMwC,EAAEjC,EAAO,KAAM,CAAE,QAAS,IAAMiC,EAAEpG,EAAuB,EAAG,EAAE,CAC9E,CACJ,CAEJ,CACF,EAGI+G,EAAmBrG,EAAS,KAAO,CACvC,KAAMH,EAAc,WAAW,KAC/B,SAAUA,EAAc,WAAW,SACnC,UAAW,KAAK,KAAKA,EAAc,WAAW,MAAQA,EAAc,WAAW,QAAQ,EACvF,eAAgB,GAChB,UAAW,CAAC,GAAI,GAAI,GAAI,GAAG,EAC3B,SAAWyG,GAAiBC,EAAiBD,CAAI,EACjD,iBAAmBE,GAAqBC,EAAqBD,CAAQ,GACrE,EAEIE,EAAeC,GAAS,IAAM,CAClCC,EAAA,CACF,EAAG,GAAG,EAEN,SAASC,GAAqB,CAC5BD,EAAA,CACF,CAEA,eAAeA,EAAcN,EAAe,CAC1C,GAAI,CACF,MAAMzG,EAAc,eAClBwF,EACAiB,GAAQzG,EAAc,WAAW,KACjCA,EAAc,WAAW,SAE7B,OAAS+B,EAAY,CACnBjC,EAAQ,MAAMiC,GAAO,SAAW,UAAU,CAC5C,CACF,CAEA,SAAS2E,EAAiBD,EAAc,CACtCM,EAAcN,CAAI,CACpB,CAEA,SAASG,EAAqBD,EAAkB,CAC9C3G,EAAc,WAAW,SAAW2G,EACpCI,EAAc,CAAC,CACjB,CAEA,SAASjB,EAAWmB,EAAoB,CACtChC,EAAO,KAAK,CAAE,KAAM,iBAAkB,OAAQ,CAAE,GAAIgC,EAAS,IAAM,CACrE,CAEA,SAASV,EAAaD,EAAaW,EAAoB,CACrD,OAAQX,EAAA,CACN,IAAK,OACHR,EAAWmB,CAAQ,EACnB,MACF,IAAK,OACH1B,EAAgB,MAAQ0B,EACxB5B,EAAa,MAAQ,GACrB,MACF,IAAK,SACH6B,EAAaD,CAAQ,EACrB,MAEN,CAEA,SAASC,EAAaD,EAAoB,CACxC9B,EAAO,QAAQ,CACb,MAAO,OACP,QAAS,YAAY8B,EAAS,OAAO,eACrC,aAAc,KACd,aAAc,KACd,gBAAiB,SAAY,CAC3B,GAAI,CACF,MAAMjH,EAAc,eAAeiH,EAAS,EAAE,EAC9CnH,EAAQ,QAAQ,MAAM,EACtBiH,EAAA,CACF,OAAShF,EAAY,CACnBjC,EAAQ,MAAMiC,GAAO,SAAW,MAAM,CACxC,CACF,EACD,CACH,CAEA,SAASoF,GAAqB,CAC5B9B,EAAa,MAAQ,GACrBE,EAAgB,MAAQ,KACxBwB,EAAA,CACF,CAEA,eAAeK,GAAe,CAC5B,GAAI,CAEF,KAAM,CAAE,MAAA1F,EAAO,UAAAmB,GAAc,MAAAwE,GAAA,sBAAA3F,EAAA,UAAAmB,CAAA,OAAM,QAAO,qBAAM,eAAAnB,EAAA,UAAAmB,CAAA,OAE1CyE,EAAatH,EAAc,UAAU,IAAIuH,IAAM,CACnD,GAAIA,EAAE,KACN,GAAIA,EAAE,QACN,IAAKA,EAAE,QACP,GAAIA,EAAE,QACN,GAAIA,EAAE,QACN,GAAIA,EAAE,MACN,GAAIA,EAAE,MACN,GAAIA,EAAE,OACN,GAAIA,EAAE,OACN,KAAMA,EAAE,aACR,KAAMA,EAAE,WAAa,IAAM,IAC3B,GAAIA,EAAE,QACN,EAEI5E,EAAKjB,EAAM,cAAc4F,CAAU,EACnC1E,EAAKlB,EAAM,WACjBA,EAAM,kBAAkBkB,EAAID,EAAI,MAAM,EAEtC,MAAM6E,EAAW,aAAa,IAAI,OAAO,cAAc,MAAM,GAAG,EAAE,CAAC,CAAC,QACpE3E,EAAUD,EAAI4E,CAAQ,EAEtB1H,EAAQ,QAAQ,MAAM,CACxB,OAASiC,EAAY,CACnBjC,EAAQ,MAAM,QAAUiC,EAAM,OAAO,CACvC,CACF,CAEA,OAAA0F,GAAU,IAAM,CACdV,EAAA,CACF,CAAC,UApXCzH,EAAA,EAAAC,EAkFM,MAlFNN,GAkFM,CAjFJkE,EAsESH,EAAA0E,EAAA,GAtED,MAAM,QAAM,CACP,iBACT,IAIU,CAJVvE,EAIUH,EAAAI,CAAA,kBAHR,IAAqE,CAArED,EAAqEH,EAAAK,CAAA,GAA3D,KAAK,UAAW,uBAAOgC,EAAA,MAAY,gBAAS,IAAI,IAAAhG,EAAA,KAAAA,EAAA,MAAJ,OAAI,cAC1D8D,EAAuDH,EAAAK,CAAA,GAA5C,uBAAOiC,EAAA,MAAe,gBAAS,IAAE,IAAAjG,EAAA,MAAAA,EAAA,OAAF,KAAE,cAC5C8D,EAA6CH,EAAAK,CAAA,GAAlC,QAAO+D,GAAY,WAAE,IAAE,IAAA/H,EAAA,MAAAA,EAAA,OAAF,KAAE,kCAKtC,IA2DU,CA3DV8D,EA2DUH,EAAAI,CAAA,GA3DD,YAAS,KAAK,oBACrB,IA+CU,CA/CVD,EA+CUH,EAAAI,CAAA,kBA9CR,IAUU,CAVVD,EAUUH,EAAA2E,EAAA,GATA,MAAOnC,EAAQ,0BAARnG,EAAA,KAAAA,EAAA,GAAA6D,GAAAsC,EAAQ,QAAOtC,GAIfF,EAAA6D,CAAA,GAHf,YAAY,oBACZ,aACA,wBAGW,SACT,IAAqC,CAArC1D,EAAqCH,EAAAY,CAAA,GAA5B,UAAWZ,EAAA4E,EAAA,GAAa,2DAIrCzE,EAOEH,EAAAqB,CAAA,GANQ,MAAOmB,EAAQ,yBAARnG,EAAA,KAAAA,EAAA,GAAA6D,GAAAsC,EAAQ,OAAMtC,GAKd8D,CAAA,EAJf,YAAY,KACZ,aACA,sBACC,QAAStB,CAAA,oBAIZvC,EAOEH,EAAAqB,CAAA,GANQ,MAAOmB,EAAQ,yBAARnG,EAAA,KAAAA,EAAA,GAAA6D,GAAAsC,EAAQ,OAAMtC,GAKd8D,CAAA,EAJf,YAAY,KACZ,aACA,sBACC,QAASrB,CAAA,oBAIZxC,EAMEH,EAAA2E,EAAA,GALQ,MAAOnC,EAAQ,0BAARnG,EAAA,KAAAA,EAAA,GAAA6D,GAAAsC,EAAQ,QAAOtC,GAIfF,EAAA6D,CAAA,GAHf,YAAY,KACZ,aACA,0DAIF1D,EAOEH,EAAAqB,CAAA,GANQ,MAAOmB,EAAQ,6BAARnG,EAAA,KAAAA,EAAA,GAAA6D,GAAAsC,EAAQ,WAAUtC,GAKlB8D,CAAA,EAJf,YAAY,OACZ,aACA,sBACC,QAASpB,CAAA,4BAMdzC,EAOEH,EAAAyB,EAAA,GANC,QAAA9C,EACA,KAAMqB,EAAAhD,CAAA,EAAc,UACpB,QAASgD,EAAAhD,CAAA,EAAc,QACvB,WAAYwG,EAAA,MACZ,UAAUvE,GAAkBA,EAAI,GAChC,gBAAayE,CAAA,oEAMpBvD,EAIE0E,GAAA,CAHQ,KAAMxC,EAAA,qCAAAA,EAAY,MAAAnC,GACzB,SAAUqC,EAAA,MACV,UAAS4B,CAAA,8BAIZhE,EAAwE2E,GAAA,CAAlD,KAAMxC,EAAA,qCAAAA,EAAe,MAAApC,GAAG,UAAS6D,CAAA","names":["_hoisted_1","CloudUploadOutline","defineComponent","_ctx","_cache","_openBlock","_createElementBlock","_createElementVNode","EllipsisVerticalOutline","props","__props","emit","__emit","message","useMessage","customerStore","useCustomerStore","showModal","computed","val","currentStep","ref","stepStatus","importing","excelData","excelColumns","columnMapping","previewData","importResult","systemFields","previewColumns","canNext","f","handleFileUpload","options","file","data","workbook","read","firstSheet","jsonData","utils","columns","col","field","matchedCol","error","handleNext","row","mapped","sysField","excelCol","handlePrev","handleImport","customers","result","downloadTemplate","template","ws","wb","writeFile","handleClose","_createBlock","_unref","NModal","$event","_createVNode","NSpace","NButton","NSteps","NStep","NDivider","NUpload","NUploadDragger","_hoisted_2","NIcon","NText","NP","NAlert","_hoisted_3","NForm","_Fragment","_renderList","NFormItem","NSelect","_hoisted_4","_createTextVNode","_toDisplayString","NDataTable","_hoisted_5","NResult","NStatistic","NCollapse","NCollapseItem","NList","NListItem","router","useRouter","dialog","useDialog","showAddModal","showImportModal","editingCustomer","filters","reactive","statusOptions","sourceOptions","isEnteredOptions","h","handleView","statusMap","type","label","NTag","NSwitch","formatDate","NDropdown","key","handleAction","paginationConfig","page","handlePageChange","pageSize","handlePageSizeChange","handleSearch","debounce","loadCustomers","handleFilterChange","customer","handleDelete","handleModalSuccess","handleExport","__vitePreload","exportData","c","fileName","onMounted","NCard","NInput","SearchOutline","CustomerFormModal","ImportModal"],"ignoreList":[0,1],"sources":["../../node_modules/@vicons/ionicons5/es/CloudUploadOutline.js","../../node_modules/@vicons/ionicons5/es/EllipsisVerticalOutline.js","../../src/components/ImportModal.vue","../../src/views/Customers.vue"],"sourcesContent":["import { createElementVNode as _createElementVNode, openBlock as _openBlock, createElementBlock as _createElementBlock, defineComponent } from 'vue'\nconst _hoisted_1 = {\n  xmlns: 'http://www.w3.org/2000/svg',\n  'xmlns:xlink': 'http://www.w3.org/1999/xlink',\n  viewBox: '0 0 512 512'\n}\nexport default defineComponent({\n  name: 'CloudUploadOutline',\n  render: function render(_ctx, _cache) {\n    return (\n      _openBlock(),\n      _createElementBlock(\n        'svg',\n        _hoisted_1,\n        _cache[0] ||\n          (_cache[0] = [\n            _createElementVNode(\n              'path',\n              {\n                d: 'M320 367.79h76c55 0 100-29.21 100-83.6s-53-81.47-96-83.6c-8.89-85.06-71-136.8-144-136.8c-69 0-113.44 45.79-128 91.2c-60 5.7-112 43.88-112 106.4s54 106.4 120 106.4h56',\n                fill: 'none',\n                stroke: 'currentColor',\n                'stroke-linecap': 'round',\n                'stroke-linejoin': 'round',\n                'stroke-width': '32'\n              },\n              null,\n              -1 /* HOISTED */\n            ),\n            _createElementVNode(\n              'path',\n              {\n                fill: 'none',\n                stroke: 'currentColor',\n                'stroke-linecap': 'round',\n                'stroke-linejoin': 'round',\n                'stroke-width': '32',\n                d: 'M320 255.79l-64-64l-64 64'\n              },\n              null,\n              -1 /* HOISTED */\n            ),\n            _createElementVNode(\n              'path',\n              {\n                fill: 'none',\n                stroke: 'currentColor',\n                'stroke-linecap': 'round',\n                'stroke-linejoin': 'round',\n                'stroke-width': '32',\n                d: 'M256 448.21V207.79'\n              },\n              null,\n              -1 /* HOISTED */\n            )\n          ])\n      )\n    )\n  }\n})\n","import { createElementVNode as _createElementVNode, openBlock as _openBlock, createElementBlock as _createElementBlock, defineComponent } from 'vue'\nconst _hoisted_1 = {\n  xmlns: 'http://www.w3.org/2000/svg',\n  'xmlns:xlink': 'http://www.w3.org/1999/xlink',\n  viewBox: '0 0 512 512'\n}\nexport default defineComponent({\n  name: 'EllipsisVerticalOutline',\n  render: function render(_ctx, _cache) {\n    return (\n      _openBlock(),\n      _createElementBlock(\n        'svg',\n        _hoisted_1,\n        _cache[0] ||\n          (_cache[0] = [\n            _createElementVNode(\n              'circle',\n              {\n                cx: '256',\n                cy: '256',\n                r: '32',\n                fill: 'none',\n                stroke: 'currentColor',\n                'stroke-miterlimit': '10',\n                'stroke-width': '32'\n              },\n              null,\n              -1 /* HOISTED */\n            ),\n            _createElementVNode(\n              'circle',\n              {\n                cx: '256',\n                cy: '416',\n                r: '32',\n                fill: 'none',\n                stroke: 'currentColor',\n                'stroke-miterlimit': '10',\n                'stroke-width': '32'\n              },\n              null,\n              -1 /* HOISTED */\n            ),\n            _createElementVNode(\n              'circle',\n              {\n                cx: '256',\n                cy: '96',\n                r: '32',\n                fill: 'none',\n                stroke: 'currentColor',\n                'stroke-miterlimit': '10',\n                'stroke-width': '32'\n              },\n              null,\n              -1 /* HOISTED */\n            )\n          ])\n      )\n    )\n  }\n})\n","<template>\n  <n-modal\n    v-model:show=\"showModal\"\n    :mask-closable=\"false\"\n    preset=\"card\"\n    title=\"导入客户数据\"\n    style=\"width: 900px;\"\n  >\n    <n-steps :current=\"currentStep\" :status=\"stepStatus\">\n      <n-step title=\"上传文件\" />\n      <n-step title=\"列映射\" />\n      <n-step title=\"预览确认\" />\n      <n-step title=\"导入结果\" />\n    </n-steps>\n\n    <n-divider />\n\n    <!-- 步骤 1: 上传文件 -->\n    <div v-if=\"currentStep === 1\" class=\"step-content\">\n      <n-upload\n        :custom-request=\"handleFileUpload\"\n        :show-file-list=\"false\"\n        accept=\".xlsx,.xls,.csv\"\n      >\n        <n-upload-dragger>\n          <div style=\"margin-bottom: 12px;\">\n            <n-icon size=\"48\" :depth=\"3\">\n              <CloudUploadOutline />\n            </n-icon>\n          </div>\n          <n-text style=\"font-size: 16px;\">\n            点击或拖拽文件到此区域上传\n          </n-text>\n          <n-p depth=\"3\" style=\"margin: 8px 0 0 0;\">\n            支持 .xlsx, .xls, .csv 格式，单个文件不超过 10MB\n          </n-p>\n        </n-upload-dragger>\n      </n-upload>\n\n      <n-divider />\n\n      <n-alert type=\"info\" title=\"导入说明\">\n        <ul>\n          <li>支持 Excel (.xlsx, .xls) 和 CSV 格式</li>\n          <li>第一行应为列标题</li>\n          <li>必填字段：公司名称、联系人、国家、产品、询盘日期</li>\n          <li>下载 <a href=\"#\" @click.prevent=\"downloadTemplate\">导入模板</a> 查看格式</li>\n        </ul>\n      </n-alert>\n    </div>\n\n    <!-- 步骤 2: 列映射 -->\n    <div v-if=\"currentStep === 2\" class=\"step-content\">\n      <n-alert type=\"info\" title=\"列映射\" style=\"margin-bottom: 16px;\">\n        请将 Excel 列名映射到系统字段\n      </n-alert>\n\n      <n-form label-placement=\"left\" label-width=\"120px\">\n        <n-form-item\n          v-for=\"field in systemFields\"\n          :key=\"field.key\"\n          :label=\"field.label\"\n          :required=\"field.required\"\n        >\n          <n-select\n            v-model:value=\"columnMapping[field.key]\"\n            :options=\"excelColumns\"\n            placeholder=\"选择对应的 Excel 列\"\n            clearable\n          />\n        </n-form-item>\n      </n-form>\n    </div>\n\n    <!-- 步骤 3: 预览确认 -->\n    <div v-if=\"currentStep === 3\" class=\"step-content\">\n      <n-alert type=\"warning\" title=\"数据预览\" style=\"margin-bottom: 16px;\">\n        共 {{ previewData.length }} 条数据，请确认无误后导入\n      </n-alert>\n\n      <n-data-table\n        :columns=\"previewColumns\"\n        :data=\"previewData.slice(0, 10)\"\n        :max-height=\"400\"\n        :pagination=\"false\"\n      />\n\n      <n-p v-if=\"previewData.length > 10\" depth=\"3\" style=\"margin-top: 8px;\">\n        仅显示前 10 条数据预览\n      </n-p>\n    </div>\n\n    <!-- 步骤 4: 导入结果 -->\n    <div v-if=\"currentStep === 4\" class=\"step-content\">\n      <n-result\n        :status=\"importResult.failed === 0 ? 'success' : 'warning'\"\n        :title=\"importResult.failed === 0 ? '导入完成' : '导入完成（部分失败）'\"\n      >\n        <template #footer>\n          <n-space vertical>\n            <n-statistic label=\"成功\" :value=\"importResult.success\" />\n            <n-statistic label=\"失败\" :value=\"importResult.failed\" />\n\n            <n-collapse v-if=\"importResult.errors.length > 0\">\n              <n-collapse-item title=\"查看错误详情\" name=\"errors\">\n                <n-list>\n                  <n-list-item v-for=\"error in importResult.errors\" :key=\"error.index\">\n                    第 {{ error.index + 1 }} 行: {{ error.error }}\n                  </n-list-item>\n                </n-list>\n              </n-collapse-item>\n            </n-collapse>\n          </n-space>\n        </template>\n      </n-result>\n    </div>\n\n    <template #footer>\n      <n-space justify=\"end\">\n        <n-button v-if=\"currentStep > 1 && currentStep < 4\" @click=\"handlePrev\">\n          上一步\n        </n-button>\n        <n-button v-if=\"currentStep < 3\" type=\"primary\" :disabled=\"!canNext\" @click=\"handleNext\">\n          下一步\n        </n-button>\n        <n-button\n          v-if=\"currentStep === 3\"\n          type=\"primary\"\n          :loading=\"importing\"\n          @click=\"handleImport\"\n        >\n          开始导入\n        </n-button>\n        <n-button v-if=\"currentStep === 4\" type=\"primary\" @click=\"handleClose\">\n          完成\n        </n-button>\n        <n-button @click=\"handleClose\">取消</n-button>\n      </n-space>\n    </template>\n  </n-modal>\n</template>\n\n<script setup lang=\"ts\">\nimport { ref, computed } from 'vue'\nimport {\n  NModal,\n  NSteps,\n  NStep,\n  NDivider,\n  NUpload,\n  NUploadDragger,\n  NIcon,\n  NText,\n  NP,\n  NAlert,\n  NForm,\n  NFormItem,\n  NSelect,\n  NDataTable,\n  NResult,\n  NStatistic,\n  NCollapse,\n  NCollapseItem,\n  NList,\n  NListItem,\n  NSpace,\n  NButton,\n  useMessage,\n  type UploadCustomRequestOptions\n} from 'naive-ui'\nimport { CloudUploadOutline } from '@vicons/ionicons5'\nimport { read, utils, writeFile } from 'xlsx'\nimport { useCustomerStore } from '@/stores/customer'\n\ninterface Props {\n  show: boolean\n}\n\nconst props = defineProps<Props>()\nconst emit = defineEmits<{\n  (e: 'update:show', value: boolean): void\n  (e: 'success'): void\n}>()\n\nconst message = useMessage()\nconst customerStore = useCustomerStore()\n\nconst showModal = computed({\n  get: () => props.show,\n  set: val => emit('update:show', val)\n})\n\nconst currentStep = ref(1)\nconst stepStatus = ref<'process' | 'finish' | 'error' | 'wait'>('process')\nconst importing = ref(false)\n\nconst excelData = ref<any[]>([])\nconst excelColumns = ref<Array<{ label: string; value: string }>>([])\nconst columnMapping = ref<Record<string, string>>({})\nconst previewData = ref<any[]>([])\n\nconst importResult = ref({\n  success: 0,\n  failed: 0,\n  errors: [] as Array<{ index: number; error: string }>\n})\n\nconst systemFields = [\n  { key: 'code', label: '客户单号', required: true },\n  { key: 'company', label: '公司名称', required: true },\n  { key: 'contact', label: '联系人', required: true },\n  { key: 'country', label: '国家/地区', required: true },\n  { key: 'product', label: '产品', required: true },\n  { key: 'inquiry_date', label: '询盘日期', required: true },\n  { key: 'email', label: '邮箱', required: false },\n  { key: 'phone', label: '电话', required: false },\n  { key: 'source', label: '客户来源', required: false },\n  { key: 'remark', label: '备注', required: false }\n]\n\nconst previewColumns = computed(() => [\n  { title: '公司', key: 'company' },\n  { title: '联系人', key: 'contact' },\n  { title: '国家', key: 'country' },\n  { title: '产品', key: 'product' },\n  { title: '邮箱', key: 'email' },\n  { title: '询盘日期', key: 'inquiry_date' }\n])\n\nconst canNext = computed(() => {\n  if (currentStep.value === 1) {\n    return excelData.value.length > 0\n  }\n  if (currentStep.value === 2) {\n    const requiredFields = systemFields.filter(f => f.required)\n    return requiredFields.every(f => columnMapping.value[f.key])\n  }\n  return true\n})\n\nasync function handleFileUpload(options: UploadCustomRequestOptions) {\n  const { file } = options\n  try {\n    const data = await file.file?.arrayBuffer()\n    if (!data) {\n      throw new Error('文件读取失败')\n    }\n\n    const workbook = read(data)\n    const firstSheet = workbook.Sheets[workbook.SheetNames[0]]\n    const jsonData = utils.sheet_to_json(firstSheet, { raw: false })\n\n    if (jsonData.length === 0) {\n      throw new Error('文件中没有数据')\n    }\n\n    excelData.value = jsonData as any[]\n\n    // 提取列名\n    const columns = Object.keys(jsonData[0] as object)\n    excelColumns.value = columns.map(col => ({ label: col, value: col }))\n\n    // 自动映射（如果列名匹配）\n    systemFields.forEach(field => {\n      const matchedCol = columns.find(col =>\n        col.toLowerCase().includes(field.label.toLowerCase())\n      )\n      if (matchedCol) {\n        columnMapping.value[field.key] = matchedCol\n      }\n    })\n\n    message.success('文件上传成功')\n    currentStep.value = 2\n  } catch (error: any) {\n    message.error('文件解析失败：' + error.message)\n  }\n}\n\nfunction handleNext() {\n  if (currentStep.value === 2) {\n    // 生成预览数据\n    previewData.value = excelData.value.map(row => {\n      const mapped: any = {}\n      Object.entries(columnMapping.value).forEach(([sysField, excelCol]) => {\n        if (excelCol) {\n          mapped[sysField] = row[excelCol]\n        }\n      })\n      return mapped\n    })\n  }\n  currentStep.value++\n}\n\nfunction handlePrev() {\n  currentStep.value--\n}\n\nasync function handleImport() {\n  importing.value = true\n  try {\n    const customers = previewData.value.map(data => ({\n      ...data,\n      status: 'new',\n      source: data.source || 'other',\n      is_entered: false\n    }))\n\n    const result = await customerStore.importCustomers(customers)\n    importResult.value = result\n\n    currentStep.value = 4\n    stepStatus.value = result.failed === 0 ? 'finish' : 'error'\n\n    if (result.failed === 0) {\n      message.success(`成功导入 ${result.success} 条数据`)\n      emit('success')\n    } else {\n      message.warning(`导入完成：成功 ${result.success} 条，失败 ${result.failed} 条`)\n    }\n  } catch (error: any) {\n    message.error('导入失败：' + error.message)\n    stepStatus.value = 'error'\n  } finally {\n    importing.value = false\n  }\n}\n\nfunction downloadTemplate() {\n  const template = [\n    {\n      客户单号: 'CUS20240101001',\n      公司名称: '示例公司 Inc.',\n      联系人: '张三',\n      '国家/地区': '美国',\n      产品: '示例产品',\n      询盘日期: '2024-01-01',\n      邮箱: 'example@company.com',\n      电话: '+1-234-567-8900',\n      客户来源: 'website',\n      备注: '这是一条示例数据'\n    }\n  ]\n\n  const ws = utils.json_to_sheet(template)\n  const wb = utils.book_new()\n  utils.book_append_sheet(wb, ws, '客户导入模板')\n\n  writeFile(wb, '客户导入模板.xlsx')\n  message.success('模板下载成功')\n}\n\nfunction handleClose() {\n  currentStep.value = 1\n  stepStatus.value = 'process'\n  excelData.value = []\n  excelColumns.value = []\n  columnMapping.value = {}\n  previewData.value = []\n  importResult.value = { success: 0, failed: 0, errors: [] }\n  emit('update:show', false)\n}\n</script>\n\n<style scoped>\n.step-content {\n  min-height: 400px;\n  padding: 24px 0;\n}\n</style>\n","<template>\n  <div class=\"customers-view\">\n    <n-card title=\"客户管理\">\n      <template #header-extra>\n        <n-space>\n          <n-button type=\"primary\" @click=\"showAddModal = true\">新增客户</n-button>\n          <n-button @click=\"showImportModal = true\">导入</n-button>\n          <n-button @click=\"handleExport\">导出</n-button>\n        </n-space>\n      </template>\n\n      <!-- 筛选条件 -->\n      <n-space vertical size=\"large\">\n        <n-space>\n          <n-input\n            v-model:value=\"filters.keyword\"\n            placeholder=\"搜索公司/联系人/邮箱/电话/单号\"\n            clearable\n            style=\"width: 300px;\"\n            @update:value=\"handleSearch\"\n          >\n            <template #prefix>\n              <n-icon :component=\"SearchOutline\" />\n            </template>\n          </n-input>\n\n          <n-select\n            v-model:value=\"filters.status\"\n            placeholder=\"状态\"\n            clearable\n            style=\"width: 150px;\"\n            :options=\"statusOptions\"\n            @update:value=\"handleFilterChange\"\n          />\n\n          <n-select\n            v-model:value=\"filters.source\"\n            placeholder=\"来源\"\n            clearable\n            style=\"width: 150px;\"\n            :options=\"sourceOptions\"\n            @update:value=\"handleFilterChange\"\n          />\n\n          <n-input\n            v-model:value=\"filters.country\"\n            placeholder=\"国家\"\n            clearable\n            style=\"width: 150px;\"\n            @update:value=\"handleSearch\"\n          />\n\n          <n-select\n            v-model:value=\"filters.is_entered\"\n            placeholder=\"是否录入\"\n            clearable\n            style=\"width: 150px;\"\n            :options=\"isEnteredOptions\"\n            @update:value=\"handleFilterChange\"\n          />\n        </n-space>\n\n        <!-- 数据表格 -->\n        <n-data-table\n          :columns=\"columns\"\n          :data=\"customerStore.customers\"\n          :loading=\"customerStore.loading\"\n          :pagination=\"paginationConfig\"\n          :row-key=\"(row: Customer) => row.id\"\n          @update:page=\"handlePageChange\"\n        />\n      </n-space>\n    </n-card>\n\n    <!-- 新增/编辑客户弹窗 -->\n    <customer-form-modal\n      v-model:show=\"showAddModal\"\n      :customer=\"editingCustomer\"\n      @success=\"handleModalSuccess\"\n    />\n\n    <!-- 导入弹窗 -->\n    <import-modal v-model:show=\"showImportModal\" @success=\"loadCustomers\" />\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { ref, reactive, computed, onMounted, h } from 'vue'\nimport { useRouter } from 'vue-router'\nimport {\n  NCard,\n  NSpace,\n  NButton,\n  NInput,\n  NSelect,\n  NDataTable,\n  NIcon,\n  NTag,\n  NSwitch,\n  NDropdown,\n  useDialog,\n  useMessage,\n  type DataTableColumns\n} from 'naive-ui'\nimport { SearchOutline, EllipsisVerticalOutline } from '@vicons/ionicons5'\nimport { useCustomerStore } from '@/stores/customer'\nimport type { Customer, CustomerFilter } from '@/types'\nimport { formatDate, debounce } from '@/utils/helpers'\nimport CustomerFormModal from '@/components/CustomerFormModal.vue'\nimport ImportModal from '@/components/ImportModal.vue'\n\nconst router = useRouter()\nconst dialog = useDialog()\nconst message = useMessage()\nconst customerStore = useCustomerStore()\n\nconst showAddModal = ref(false)\nconst showImportModal = ref(false)\nconst editingCustomer = ref<Customer | null>(null)\n\nconst filters = reactive<CustomerFilter>({\n  keyword: '',\n  status: undefined,\n  source: undefined,\n  country: '',\n  is_entered: undefined\n})\n\nconst statusOptions = [\n  { label: '样品已成交', value: 'sample_won' },\n  { label: '洽谈中', value: 'negotiating' },\n  { label: '排产中', value: 'in_production' },\n  { label: '已完成', value: 'completed' },\n  { label: '新一轮洽谈', value: 'new_round' },\n  { label: '已被他人成交', value: 'won_by_others' },\n  { label: '潜在客户', value: 'potential' },\n  { label: '高价值客户', value: 'high_value' },\n  { label: '无回复', value: 'no_response' },\n  { label: '不可执行', value: 'not_executable' },\n  { label: '低优先级', value: 'low_priority' }\n]\n\nconst sourceOptions = [\n  { label: '网站', value: 'website' },\n  { label: '邮件', value: 'email' },\n  { label: '展会', value: 'exhibition' },\n  { label: '转介绍', value: 'referral' },\n  { label: '电话营销', value: 'cold_call' },\n  { label: '社交媒体', value: 'social_media' },\n  { label: '其他', value: 'other' }\n]\n\nconst isEnteredOptions = [\n  { label: '已录入', value: true },\n  { label: '未录入', value: false }\n]\n\nconst columns: DataTableColumns<Customer> = [\n  {\n    title: '单号',\n    key: 'code',\n    width: 150,\n    fixed: 'left',\n    render: row => h('a', { onClick: () => handleView(row) }, row.code)\n  },\n  {\n    title: '公司',\n    key: 'company',\n    width: 200,\n    ellipsis: { tooltip: true }\n  },\n  {\n    title: '联系人',\n    key: 'contact',\n    width: 120\n  },\n  {\n    title: '国家',\n    key: 'country',\n    width: 100\n  },\n  {\n    title: '产品',\n    key: 'product',\n    width: 150,\n    ellipsis: { tooltip: true }\n  },\n  {\n    title: '状态',\n    key: 'status',\n    width: 120,\n    render: row => {\n      const statusMap: Record<string, { type: any; label: string }> = {\n        sample_won: { type: 'success', label: '样品已成交' },\n        negotiating: { type: 'info', label: '洽谈中' },\n        in_production: { type: 'warning', label: '排产中' },\n        completed: { type: 'success', label: '已完成' },\n        new_round: { type: 'info', label: '新一轮洽谈' },\n        won_by_others: { type: 'error', label: '已被他人成交' },\n        potential: { type: 'default', label: '潜在客户' },\n        high_value: { type: 'success', label: '高价值客户' },\n        no_response: { type: 'warning', label: '无回复' },\n        not_executable: { type: 'error', label: '不可执行' },\n        low_priority: { type: 'default', label: '低优先级' }\n      }\n      const { type, label } = statusMap[row.status] || { type: 'default', label: row.status }\n      return h(NTag, { type, size: 'small' }, { default: () => label })\n    }\n  },\n  {\n    title: '是否录入',\n    key: 'is_entered',\n    width: 100,\n    render: row => h(NSwitch, { value: row.is_entered, disabled: true })\n  },\n  {\n    title: '询盘日期',\n    key: 'inquiry_date',\n    width: 120,\n    render: row => formatDate(row.inquiry_date)\n  },\n  {\n    title: '负责人',\n    key: 'owner',\n    width: 120,\n    render: row => row.owner?.name || row.owner?.email || '-'\n  },\n  {\n    title: '操作',\n    key: 'actions',\n    width: 80,\n    fixed: 'right',\n    render: row => {\n      return h(\n        NDropdown,\n        {\n          options: [\n            { label: '查看', key: 'view' },\n            { label: '编辑', key: 'edit' },\n            { label: '删除', key: 'delete' }\n          ],\n          onSelect: (key: string) => handleAction(key, row)\n        },\n        {\n          default: () =>\n            h(\n              NButton,\n              { text: true },\n              { icon: () => h(NIcon, null, { default: () => h(EllipsisVerticalOutline) }) }\n            )\n        }\n      )\n    }\n  }\n]\n\nconst paginationConfig = computed(() => ({\n  page: customerStore.pagination.page,\n  pageSize: customerStore.pagination.pageSize,\n  pageCount: Math.ceil(customerStore.pagination.total / customerStore.pagination.pageSize),\n  showSizePicker: true,\n  pageSizes: [10, 20, 50, 100],\n  onChange: (page: number) => handlePageChange(page),\n  onUpdatePageSize: (pageSize: number) => handlePageSizeChange(pageSize)\n}))\n\nconst handleSearch = debounce(() => {\n  loadCustomers()\n}, 500)\n\nfunction handleFilterChange() {\n  loadCustomers()\n}\n\nasync function loadCustomers(page?: number) {\n  try {\n    await customerStore.fetchCustomers(\n      filters,\n      page || customerStore.pagination.page,\n      customerStore.pagination.pageSize\n    )\n  } catch (error: any) {\n    message.error(error?.message || '加载客户列表失败')\n  }\n}\n\nfunction handlePageChange(page: number) {\n  loadCustomers(page)\n}\n\nfunction handlePageSizeChange(pageSize: number) {\n  customerStore.pagination.pageSize = pageSize\n  loadCustomers(1)\n}\n\nfunction handleView(customer: Customer) {\n  router.push({ name: 'CustomerDetail', params: { id: customer.id } })\n}\n\nfunction handleAction(key: string, customer: Customer) {\n  switch (key) {\n    case 'view':\n      handleView(customer)\n      break\n    case 'edit':\n      editingCustomer.value = customer\n      showAddModal.value = true\n      break\n    case 'delete':\n      handleDelete(customer)\n      break\n  }\n}\n\nfunction handleDelete(customer: Customer) {\n  dialog.warning({\n    title: '确认删除',\n    content: `确定要删除客户 \"${customer.company}\" 吗？此操作不可恢复。`,\n    positiveText: '删除',\n    negativeText: '取消',\n    onPositiveClick: async () => {\n      try {\n        await customerStore.deleteCustomer(customer.id)\n        message.success('删除成功')\n        loadCustomers()\n      } catch (error: any) {\n        message.error(error?.message || '删除失败')\n      }\n    }\n  })\n}\n\nfunction handleModalSuccess() {\n  showAddModal.value = false\n  editingCustomer.value = null\n  loadCustomers()\n}\n\nasync function handleExport() {\n  try {\n    // 导出当前筛选条件下的所有数据\n    const { utils, writeFile } = await import('xlsx')\n\n    const exportData = customerStore.customers.map(c => ({\n      单号: c.code,\n      公司: c.company,\n      联系人: c.contact,\n      国家: c.country,\n      产品: c.product,\n      邮箱: c.email,\n      电话: c.phone,\n      状态: c.status,\n      来源: c.source,\n      询盘日期: c.inquiry_date,\n      是否录入: c.is_entered ? '是' : '否',\n      备注: c.remark\n    }))\n\n    const ws = utils.json_to_sheet(exportData)\n    const wb = utils.book_new()\n    utils.book_append_sheet(wb, ws, '客户列表')\n\n    const fileName = `customers_${new Date().toISOString().split('T')[0]}.xlsx`\n    writeFile(wb, fileName)\n\n    message.success('导出成功')\n  } catch (error: any) {\n    message.error('导出失败：' + error.message)\n  }\n}\n\nonMounted(() => {\n  loadCustomers()\n})\n</script>\n\n<style scoped>\n.customers-view {\n  height: 100%;\n}\n</style>\n"],"file":"assets/Customers-DxNcQ_io.js"}