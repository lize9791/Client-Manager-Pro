const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["Client-Manager-Pro/assets/js/Login-BDXJJIMK.js","Client-Manager-Pro/assets/js/vue-vendor-AGKXruha.js","Client-Manager-Pro/assets/js/helpers-Ba1kvV6f.js","Client-Manager-Pro/assets/js/naive-ui-DL6zjJD3.js","Client-Manager-Pro/assets/js/_plugin-vue_export-helper-BCo6x5W8.js","Client-Manager-Pro/assets/js/supabase-BUHeOf8C.js","Client-Manager-Pro/assets/css/Login-DSun2xSl.css","Client-Manager-Pro/assets/js/MainLayout-EWHJ9w2f.js","Client-Manager-Pro/assets/js/CustomerFormModal.vue_vue_type_script_setup_true_lang-CV9OQ1-V.js","Client-Manager-Pro/assets/js/customer-yRo_pr2K.js","Client-Manager-Pro/assets/js/StatsChartOutline-DPUErrvf.js","Client-Manager-Pro/assets/js/DocumentTextOutline-BCRJIBAN.js","Client-Manager-Pro/assets/js/SearchOutline-C3SMgW99.js","Client-Manager-Pro/assets/css/MainLayout-Djv76iEb.css","Client-Manager-Pro/assets/js/Dashboard-CMhrVaey.js","Client-Manager-Pro/assets/js/TimeOutline-B_AJ_rR8.js","Client-Manager-Pro/assets/css/Dashboard-DnWHpWG7.css","Client-Manager-Pro/assets/js/Customers-CrUjSyEi.js","Client-Manager-Pro/assets/js/excel-C3s_O8KD.js","Client-Manager-Pro/assets/css/Customers-aOfC-jNo.css","Client-Manager-Pro/assets/js/CustomerDetail-BaLd2BDc.js","Client-Manager-Pro/assets/css/CustomerDetail-B_Ri0xd0.css","Client-Manager-Pro/assets/js/Orders-DBlpkoMc.js","Client-Manager-Pro/assets/css/Orders-rOFwk0AH.css","Client-Manager-Pro/assets/js/Reports-BLcIMT5e.js","Client-Manager-Pro/assets/css/Reports-FJVRDM2r.css","Client-Manager-Pro/assets/js/Settings-BI89_1EZ.js","Client-Manager-Pro/assets/css/Settings-Br-2FF6o.css"])))=>i.map(i=>d[i]);
import{S as e,r,c as t,U as a,V as s,k as n,W as o,N as i,X as l,Y as u,Z as c,_ as m,M as d,$ as p}from"./vue-vendor-AGKXruha.js";import{c as f}from"./supabase-BUHeOf8C.js";import{N as h,a as _,b as y,c as g,n as v}from"./naive-ui-DL6zjJD3.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))r(e);new MutationObserver(e=>{for(const t of e)if("childList"===t.type)for(const e of t.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&r(e)}).observe(document,{childList:!0,subtree:!0})}function r(e){if(e.ep)return;e.ep=!0;const r=function(e){const r={};return e.integrity&&(r.integrity=e.integrity),e.referrerPolicy&&(r.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?r.credentials="include":"anonymous"===e.crossOrigin?r.credentials="omit":r.credentials="same-origin",r}(e);fetch(e.href,r)}}();const w={},E=function(e,r,t){let a=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const e=document.querySelector("meta[property=csp-nonce]"),t=e?.nonce||e?.getAttribute("nonce");a=Promise.allSettled(r.map(e=>{if((e=function(e){return"/Client-Manager-Pro/"+e}(e))in w)return;w[e]=!0;const r=e.endsWith(".css"),a=r?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${e}"]${a}`))return;const s=document.createElement("link");return s.rel=r?"stylesheet":"modulepreload",r||(s.as="script"),s.crossOrigin="",s.href=e,t&&s.setAttribute("nonce",t),document.head.appendChild(s),r?new Promise((r,t)=>{s.addEventListener("load",r),s.addEventListener("error",()=>t(new Error(`Unable to preload CSS for ${e}`)))}):void 0}))}function s(e){const r=new Event("vite:preloadError",{cancelable:!0});if(r.payload=e,window.dispatchEvent(r),!r.defaultPrevented)throw e}return a.then(r=>{for(const e of r||[])"rejected"===e.status&&s(e.reason);return e().catch(s)})},I=f("https://pqbneojpksizuigsglce.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InBxYm5lb2pwa3NpenVpZ3NnbGNlIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjEyODcxMDgsImV4cCI6MjA3Njg2MzEwOH0.lr8G6dn2nTQy4pPQKb7HgVw8Imms71QjDEAPJjB-rjg",{auth:{persistSession:!0,autoRefreshToken:!0,detectSessionInUrl:!0}}),S={CUSTOMERS:"customers",ORDERS:"orders",FOLLOWUPS:"followups",ATTACHMENTS:"attachments",USERS:"users"},A=e("auth",()=>{const e=r(null),a=r(null),s=r(!1),n=t(()=>!!e.value),o=t(()=>e.value?.role||"viewer"),i=t(()=>"admin"===o.value),l=t(()=>"sales"===o.value),u=t(()=>"viewer"===o.value);async function c(r){try{const{data:t,error:a}=await I.from("users").select("*").eq("id",r).maybeSingle();if(a)throw a;if(t)e.value=t;else{const r=(await I.auth.getUser()).data.user;if(r){const t={id:r.id,email:r.email,name:r.user_metadata?.name||r.email.split("@")[0],role:"sales"},{data:a,error:s}=await I.from("users").insert(t).select().single();s?console.error("Failed to create user profile:",s):e.value=a}}}catch(t){console.error("Failed to fetch user profile:",t)}}return{user:e,session:a,loading:s,isAuthenticated:n,userRole:o,isAdmin:i,isSales:l,isViewer:u,initialize:async function(){s.value=!0;try{const{data:{session:r}}=await I.auth.getSession();r&&(a.value=r,await c(r.user.id)),I.auth.onAuthStateChange(async(r,t)=>{a.value=t,t?.user?await c(t.user.id):e.value=null})}catch(r){console.error("Failed to initialize auth:",r)}finally{s.value=!1}},signIn:async function(e,r){s.value=!0;try{const{data:t,error:s}=await I.auth.signInWithPassword({email:e,password:r});return s||(a.value=t.session,t.user&&await c(t.user.id),null)}catch(t){return console.error("Sign in error:",t),t}finally{s.value=!1}},signUp:async function(e,r,t){s.value=!0;try{const{data:a,error:s}=await I.auth.signUp({email:e,password:r,options:{data:{name:t}}});if(s)return s;if(a.user){const{error:r}=await I.from("users").insert({id:a.user.id,email:a.user.email,name:t||e.split("@")[0],role:"sales"});r&&console.error("Failed to create user profile:",r)}return null}catch(a){return console.error("Sign up error:",a),a}finally{s.value=!1}},signOut:async function(){s.value=!0;try{await I.auth.signOut(),e.value=null,a.value=null}catch(r){console.error("Sign out error:",r)}finally{s.value=!1}},updateProfile:async function(r){if(!e.value)return!1;try{const{error:t}=await I.from("users").update(r).eq("id",e.value.id);if(t)throw t;return e.value={...e.value,...r},!0}catch(t){return console.error("Update profile error:",t),!1}}}}),O=[{path:"/login",name:"Login",component:()=>E(()=>import("./Login-BDXJJIMK.js"),__vite__mapDeps([0,1,2,3,4,5,6])),meta:{requiresAuth:!1}},{path:"/",component:()=>E(()=>import("./MainLayout-EWHJ9w2f.js"),__vite__mapDeps([7,1,2,8,9,3,10,11,12,4,5,13])),meta:{requiresAuth:!0},children:[{path:"",name:"Dashboard",component:()=>E(()=>import("./Dashboard-CMhrVaey.js"),__vite__mapDeps([14,1,2,3,10,15,4,5,16]))},{path:"customers",name:"Customers",component:()=>E(()=>import("./Customers-CrUjSyEi.js"),__vite__mapDeps([17,1,9,2,8,3,18,4,12,5,19]))},{path:"customers/:id",name:"CustomerDetail",component:()=>E(()=>import("./CustomerDetail-BaLd2BDc.js"),__vite__mapDeps([20,1,9,2,8,3,4,5,21]))},{path:"orders",name:"Orders",component:()=>E(()=>import("./Orders-DBlpkoMc.js"),__vite__mapDeps([22,1,9,2,3,12,11,15,4,5,23]))},{path:"reports",name:"Reports",component:()=>E(()=>import("./Reports-BLcIMT5e.js"),__vite__mapDeps([24,1,3,4,25]))},{path:"settings",name:"Settings",component:()=>E(()=>import("./Settings-BI89_1EZ.js"),__vite__mapDeps([26,1,3,4,27])),meta:{requiresAdmin:!0}}]}],P=a({history:s(),routes:O});P.beforeEach(async(e,r,t)=>{const a=A();let s=0;for(;a.loading&&s<30;)await new Promise(e=>setTimeout(e,100)),s++;const n=e.matched.some(e=>!1!==e.meta.requiresAuth),o=e.matched.some(e=>e.meta.requiresAdmin);n&&!a.isAuthenticated?t({name:"Login",query:{redirect:e.fullPath}}):o&&!a.isAdmin||"Login"===e.name&&a.isAuthenticated?t({name:"Dashboard"}):t()});const b=d(n({__name:"App",setup(e){const r={common:{primaryColor:"#18a058",primaryColorHover:"#36ad6a",primaryColorPressed:"#0c7a43",primaryColorSuppl:"#36ad6a"}};return(e,t)=>{const a=l("router-view");return u(),o(i(h),{"theme-overrides":r},{default:c(()=>[m(i(_),null,{default:c(()=>[m(i(y),null,{default:c(()=>[m(i(g),null,{default:c(()=>[m(a)]),_:1})]),_:1})]),_:1})]),_:1})}}})),L=p();b.use(L),b.use(P),b.use(v);A().initialize().then(()=>{b.mount("#app")});export{S as T,E as _,I as s,A as u};
